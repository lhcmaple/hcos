;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;hcos
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

	AREA RESET,DATA,READONLY
VECTORS_START
	DCD MSP_TOP
	DCD RESET_HANDLER
	DCD 0
	DCD 0
	DCD 0
	DCD 0
	DCD 0
	DCD 0
	DCD 0
	DCD 0
	DCD 0
	DCD 0
	DCD 0
	DCD 0
	DCD 0
	DCD SYS_HANDLER
VECTORS_END
VECTORS_SIZE EQU VECTORS_END-VECTORS_START


	AREA CODESEG,CODE,READONLY
	IMPORT main
	IMPORT current

RESET_HANDLER PROC
	B main
	ENDP

SYS_HANDLER PROC
	MRS R0,PSP
	STMDB R0!,{R4-R11}
	LDR R1,=current
	LDR R2,[R1]
	STR R0,[R2]
	LDR R0,[R2,#0x04]
	STR R0,[R1]
	LDR R0,[R0]
	LDMIA R0!,{R4-R11}
	MSR PSP,R0
 	BX LR
	ENDP
	NOP;¶ÔÆë×÷ÓÃ


	AREA STACKSEG,NOINIT,READWRITE,ALIGN=3
MSP_SIZE EQU 0x00004000
MSP_BASE
	SPACE MSP_SIZE
MSP_TOP


	END